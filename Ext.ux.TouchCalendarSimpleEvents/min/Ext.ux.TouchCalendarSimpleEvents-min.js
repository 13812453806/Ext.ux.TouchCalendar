Ext.ux.CalendarSimpleEvents=Ext.extend(Ext.util.Observable,{dateField:"start",multiEventDots:true,wrapperCls:"simple-event-wrapper",eventDotCls:"simple-event",dotWidth:6,eventTpl:new Ext.XTemplate('<span class="{wrapperCls}">','<tpl for="events">','<span class="{[parent.eventDotCls]}"></span>',"</tpl>","</span>"),filterFn:function(b,c,a){return b.get(this.dateField).clearTime(true).getTime()===a.clearTime(true).getTime()},init:function(a){this.calendar=a;this.calendar.simpleEventsPlugin=this;this.wrapperCls=this.wrapperCls+(this.multiEventDots?"-multi":"");this.eventDotCls=this.eventDotCls+(this.multiEventDots?"-multi":"");this.calendar.showEvents=this.showEvents;this.calendar.hideEvents=this.hideEvents;this.calendar.removeEvents=this.removeEvents;this.calendar.on({refresh:this.renderEvents,initialrender:this.renderEvents,scope:this})},renderEvents:function(){if(!this.disabled){var a=this.calendar.dateCollection;if(a){a.each(function(d){var f=d.date;var c=this.calendar.getDateCell(f);var e=this.calendar.store;if(c){e.clearFilter();var b=e[this.multiEventDots?"filterBy":"findBy"](Ext.createDelegate(this.filterFn,this,[f],true));var i=e.getRange().length;if((!this.multiEventDots&&b>-1)||(this.multiEventDots&&i>0)){var h=Math.min((c.getWidth()/this.dotWidth),i);var g=this.eventTpl.append(c,{events:(this.multiEventDots?e.getRange().slice(0,h):["event"]),wrapperCls:this.wrapperCls,eventDotCls:this.eventDotCls},true);g.setWidth(Math.min((this.multiEventDots?e.getRange().length:1)*this.dotWidth,c.getWidth()));g.setY((c.getY()+c.getHeight())-(g.getHeight()+(c.getHeight()*0.1)));g.setX((c.getX()+(c.getWidth()/2))-(g.getWidth()/2))}}},this)}}},hideEvents:function(){this.simpleEventsPlugin.disabled=true;this.body.select("span."+this.wrapperCls).hide()},showEvents:function(){this.simpleEventsPlugin.disabled=false;this.body.select("span."+this.wrapperCls).show()},removeEvents:function(){this.body.select("span."+this.wrapperCls).remove()}});